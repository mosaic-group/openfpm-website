<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="/img/openfpm.png">
        <meta name="keywords" content="Particle Methods Library,Particle Methods Code,Particle Methods C++,SPH C++,DC-PSE C++,Active Matter C++,Molecular Dynamics C++,Sparse Grid C++">
<!--	<title></title>  -->
        <title>OpenFPM - C++ framework for parallel particle-mesh codes</title>

        <link href="../css/bootstrap-mkdocs.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/highlight.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- Main title -->
            <a class="navbar-brand" href="http://openfpm.mpi-cbg.de/">OpenFPM</a>
        </div>

        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../vector-example/">Vector</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li class="active">
                                 <a href="./">Build from source</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../docker/">Docker</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="http://ppmcore.mpi-cbg.de/doxygen/openfpm/">Doxygen</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../news/">News</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../videos/">Videos</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../hackathon23/">Hackathon 2022/2023</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../hackathon24/">Hackathon 2023/2024</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../about/">Cite us</a>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../download/">Download</a>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li>
                    <a href="https://github.com/mosaic-group/openfpm_pdata/">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        
        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#building-from-source">Building from source</a></li>
        
            <li><a href="#list-of-supported-os">List of Supported OS</a></li>
        
            <li><a href="#git-subprojects">Git Subprojects</a></li>
        
            <li><a href="#dependencies">Dependencies</a></li>
        
            <li><a href="#building-openfpm">Building OpenFPM</a></li>
        
            <li><a href="#running-tests-and-examples">Running Tests and Examples</a></li>
        
    
    
    </ul>
</div>

<!-- Developer notes:
  See the MkDocs documentation in https://www.mkdocs.org/dev-guide/themes/#page
  and the Jinja2 template API in https://tedboy.github.io/jinja2/index.html
--></div> <!-- toc on top on mobile -->
            <div class="col-md-9" role="main">

<h1 id="building-from-source">Building from source</h1>
<h2 id="list-of-supported-os">List of Supported OS</h2>
<table>
<thead>
<tr>
<th>OS</th>
<th>Architecture</th>
<th>Support</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linux</td>
<td>x86-64/arm64</td>
<td>Yes/No</td>
</tr>
<tr>
<td>macOS</td>
<td>x86-64/arm64</td>
<td>Yes/Yes</td>
</tr>
<tr>
<td>FreeBSD</td>
<td>x86-64/arm64</td>
<td>No/No</td>
</tr>
<tr>
<td>Windows (*only with Cygwin)</td>
<td>x86-64/arm64</td>
<td>Yes/No</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="git-subprojects">Git Subprojects</h2>
<p>OpenFPM includes the following subprojects</p>
<table>
<thead>
<tr>
<th>Submodule</th>
<th>Purpose</th>
<th>Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_devices">openfpm_devices</a></td>
<td>Memory management, GPU primitives</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_data">openfpm_data</a></td>
<td>Serial data structures</td>
<td>openfpm_devices</td>
</tr>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_vcluster">openfpm_vcluster</a></td>
<td>Parallel communication</td>
<td>openfpm_data</td>
</tr>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_io">openfpm_io</a></td>
<td>Serial/Parallel Input-Output</td>
<td>openfpm_data, openfpm_vcluster</td>
</tr>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_pdata">openfpm_pdata</a></td>
<td>Parallel data structures</td>
<td>openfpm_devices, openfpm_data, openfpm_vcluster, openfpm_io</td>
</tr>
<tr>
<td><a href="https://github.com/mosaic-group/openfpm_numerics">openfpm_numerics</a></td>
<td>Numerical algorithms</td>
<td>openfpm_data, openfpm_vcluster, openfpm_io, openfpm_pdata</td>
</tr>
</tbody>
</table>
<hr />
<p>The subprojects managed using <em>Git submodules</em>. Please refer to this <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">manual</a> on how to use this tool:</p>
<pre><code class="sh">git clone https://github.com/mosaic-group/openfpm_pdata
cd openfpm_pdata
git submodule init
git submodule update 
</code></pre>

<h2 id="dependencies">Dependencies</h2>
<h3 id="install-prerequisites">Install prerequisites</h3>
<pre><code class="sh"># for linux-based systems
apt-get install build-essential make cmake make cmake git bzip2 libbz2-dev python-dev wget
# or 
apt-get install gcc g++ gfortran libtool libxml2-dev libxslt-dev make cmake git bzip2 libbz2-dev python-dev wget 
# for other systems
yum install g++ gcc-gfortran libtool make cmake git bzip2 bzip2-devel python-devel libxml2-devel libxslt-devel wget
brew install gcc49 gcc-gfortran libtool make cmake git python bzip2 wget 
</code></pre>

<p>OpenFPM is build upon the following open-source tools. Please intall these by building from source or with a package manager. </p>
<h3 id="building-dependencies-from-source">Building dependencies from source</h3>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Submodule</th>
<th>Description</th>
<th>Optional</th>
<th>OpenFPM Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.open-mpi.org/">Open MPI</a></td>
<td>openfpm_vcluster</td>
<td>The Open MPI Project is an open source <a href="https://www.mpi-forum.org/">Message Passing Interface</a> implementation</td>
<td>NO</td>
<td>4.1.6 (we do not support building from source on cygwin, has to be preinstalled)</td>
</tr>
<tr>
<td><a href="https://web-docs.gsi.de/~mkretz/Vc-0.7/index.html">Vc</a></td>
<td>openfpm_data</td>
<td>The library is a collection of SIMD vector classes with existing implementations for SSE, AVX, and a scalar fallback</td>
<td>NO</td>
<td>1.4.4</td>
</tr>
<tr>
<td><a href="http://glaros.dtc.umn.edu/gkhome/metis/metis/overview">METIS</a></td>
<td>openfpm_pdata</td>
<td>METIS is a set of serial programs for partitioning graphs and producing fill reducing orderings for sparse matrices</td>
<td>YES (or ParMETIS)</td>
<td>5.1.0</td>
</tr>
<tr>
<td><a href="http://glaros.dtc.umn.edu/gkhome/metis/parmetis/overview">ParMETIS</a></td>
<td>openfpm_pdata, openfpm_numerics</td>
<td>Extends the functionality of METIS and includes routines that are especially suited for parallel AMR computations and large scale numerical simulations</td>
<td>YES (or METIS)</td>
<td>4.0.3</td>
</tr>
<tr>
<td><a href="https://www.boost.org/">BOOST</a></td>
<td>openfpm_data, openfpm_vcluster, openfpm_io, openfpm_pdata, openfpm_numerics</td>
<td>Set of libraries that provides support for templated data structures, multithreading, unit testing etc.</td>
<td>NO</td>
<td>1.84.0 (*works on arm64 macOS only with <code>clang</code>)</td>
</tr>
<tr>
<td><a href="https://www.zlib.net/">zlib</a></td>
<td>openfpm_io</td>
<td>Lossless data-compression library needed by HDF5 to deflate stored files</td>
<td>NO</td>
<td>1.3.1 (*doesn't work on Windows)</td>
</tr>
<tr>
<td><a href="https://www.hdfgroup.org/">HDF5</a></td>
<td>openfpm_io</td>
<td>Distributed file format that supports large, complex, heterogeneous data</td>
<td>NO</td>
<td>1.14.3</td>
</tr>
<tr>
<td><a href="https://www.hdfgroup.org/">libhilbert</a></td>
<td>openfpm_data</td>
<td>Library producing Hilbert indices for multidimensional data to iterate through the grid elements following an Hilbert space filling curve.</td>
<td>NO</td>
<td>master (*no active support)</td>
</tr>
<tr>
<td><a href="http://www.openblas.net/">OpenBLAS</a></td>
<td>openfpm_numerics</td>
<td>An optimized BLAS (Basic Linear Algebra Subprograms) library, used for performing basic vector and matrix operations</td>
<td>NO</td>
<td>0.3.26</td>
</tr>
<tr>
<td><a href="https://people.engr.tamu.edu/davis/suitesparse.html">suitesparse</a></td>
<td>openfpm_numerics</td>
<td>A suite of sparse matrix algorithms. Here UMFPACK - multifrontal LU factorization module. Requires [OpenBLAS](http://www.openblas.net/]</td>
<td>NO</td>
<td>5.7.2</td>
</tr>
<tr>
<td><a href="https://eigen.tuxfamily.org/index.php">Eigen</a></td>
<td>openfpm_numerics</td>
<td>Template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms. Requires <a href="https://people.engr.tamu.edu/davis/suitesparse.html">suitesparse</a></td>
<td>Yes (or Petsc)</td>
<td>3.4.0</td>
</tr>
<tr>
<td><a href="https://github.com/blitzpp/blitz">Blitz++</a></td>
<td>openfpm_numerics</td>
<td>A meta-template library for array manipulation in C++ with a speed comparable to Fortran implementations, while preserving an object-oriented interface</td>
<td>NO</td>
<td>1.0.2</td>
</tr>
<tr>
<td><a href="https://algoim.github.io">Algoim</a></td>
<td>openfpm_numerics</td>
<td>A collection of high-order accurate numerical methods and C++ algorithms for working with implicitly-defined geometry and level set methods. Requires <a href="https://github.com/blitzpp/blitz">Blitz++</a></td>
<td>NO</td>
<td>master</td>
</tr>
<tr>
<td><a href="https://petsc.org/">PETSc</a></td>
<td>openfpm_numerics</td>
<td>Scientific computation toolkit for linear and non-linear solvers, preconditioners, time integrators. Installs HYPRE, MUMPS, ScaLAPACK, SuperLU_DIST. Requires <a href="http://www.openblas.net/">OpenBLAS</a>, <a href="https://people.engr.tamu.edu/davis/suitesparse.html">suitesparse</a>, <a href="http://glaros.dtc.umn.edu/gkhome/metis/parmetis/overview">ParMETIS</a></td>
<td>Yes (or Eigen)</td>
<td>3.19.6</td>
</tr>
<tr>
<td><a href="https://rocm.docs.amd.com/projects/HIP/en/latest/">HIP</a></td>
<td>openfpm_devices</td>
<td>A C++ runtime API and kernel language that allows developers to create portable applications for AMD and NVIDIA GPUs from single source code. One of the alternative execution backends for CUDA-like code supported by OpenFPM</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td><a href="https://alpaka.readthedocs.io/en/latest/index.html">alpaka</a></td>
<td>openfpm_devices</td>
<td>A header-only C++17 abstraction library for accelerator development. One of the alternative execution backends for CUDA-like code supported by OpenFPM</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<p>OpenFPM uses <a href="https://docs.nvidia.com/cuda/gpudirect-rdma/index.html">GPUDirect RDMA</a> to move data from one GPU to another GPU (intranode and extranode) without moving the data to host. This feature requires that OpenMPI is compiled with CUDA support. It can without this feature as well using GPUDirect of an old version (1.0). In practice it requires that MPI works with host pinned memory allocated with CUDA. This feature has been introduced with CUDA 5.0 in 2010. At best of our knowledge this feature should work without special compilation options for OpenMPI. On the other end we found several problems with GPUDirect v1.0 and Infiniband cards, when OpenMPI is not compiled with CUDA support. If you are on a super-computer or a machine you did not set-up, we suggest to re-install OpenMPI with CUDA support using the options suggested. Alternatively you can use the OpenMPI already provied.</p>
<pre><code class="sh"># here for gcc/g++. Also for icc/icpc and clang/clang++
# to enable gpuaccelerated code, set GPU_SUPPORT=1
export CC=gcc \
  CXX=g++ \
  F77=gfortran \
  FC=gfortran \
  PREFIX_DEPENDS=/home/test/openfpm_dependencies \
  PREFIX_OPENFPM=/home/test/openfpm_install \
  NCORE=4 \
  GPU_SUPPORT=0 

./script/install_MPI.sh $PREFIX_DEPENDS $NCORE $GPU_SUPPORT $CC $CXX $F77 $FC &quot;--with-mpivendor=openmpi&quot;
export PATH=&quot;$PREFIX_DEPENDS/MPI/bin:$PATH&quot;

./script/install_Metis.sh $PREFIX_DEPENDS $NCORE $CC $CXX 
# Parmetis uses mpicc in make config by default
./script/install_Parmetis.sh $PREFIX_DEPENDS $NCORE 
./script/install_BOOST.sh $PREFIX_DEPENDS $NCORE
./script/install_HDF5.sh $PREFIX_DEPENDS $NCORE
# Zlib uses CC=mpicc in ./configure
./script/install_ZLIB.sh $PREFIX_DEPENDS $NCORE
./script/install_LIBHILBERT.sh $PREFIX_DEPENDS $NCORE
./script/install_VCDEVEL.sh $PREFIX_DEPENDS $NCORE $CC $CXX
./script/install_OPENBLAS.sh $PREFIX_DEPENDS $NCORE
./script/install_SUITESPARSE.sh $PREFIX_DEPENDS $NCORE
./script/install_EIGEN.sh $PREFIX_DEPENDS $NCORE
./script/install_BLITZ.sh $PREFIX_DEPENDS $NCORE
./script/install_ALGOIM.sh $PREFIX_DEPENDS $NCORE
./script/install_PETSC.sh $PREFIX_DEPENDS $NCORE $CC $CXX $F77 $FC

</code></pre>

<h2 id="building-openfpm">Building OpenFPM</h2>
<p>OpenFPM uses CMake build system. For it to function properly, CMake has to be able to locate
the dependencies of OpenFPM. If they are not installed system-wide, the following script passes their locations to CMake</p>
<pre><code class="sh">./script/conf_CMake.sh $PREFIX_DEPENDS $PREFIX_OPENFPM
</code></pre>

<p>The resultant CMake command is echoed to the terminal window and saved into the file <em>cmake_build_options</em>.</p>
<p>CMake config options are exported to header files to be used in the project</p>
<pre><code class="sh">mkdir -p openfpm_devices/scr/config openfpm_io/scr/config openfpm_data/scr/config openfpm_numerics/scr/config openfpm_vcluster/scr/config
</code></pre>

<pre><code class="sh">mkdir build
cd build 
#insert the output of conf_CMake.sh and run the command
# &lt;INSERT HERE&gt;
make VERBOSE=1  -j $NCORE
make install
</code></pre>

<p>If the dependencies are not installed system-wide, but build from source, two environment variables have to be set accordingly: </p>
<ul>
<li><em>LD_LIBRARY_PATH</em> so the dynamic link loader knows where to search for the dynamic shared libraries;</li>
<li><em>PATH</em> so the binary files could be executed without specifying the full path, e.q. <code>mpic++</code></li>
</ul>
<p>This could be done manually (e.g. by modifying <em>~/.bashrc</em>,<em>~/.zshrc</em>...) or with the following tool that produces the file
<em>openfpm_vars</em>. This file has to be sourced every time in a new session before running OpenFPM related code.</p>
<pre><code class="sh">./script/create_env_vars.sh $PREFIX_DEPENDS $PREFIX_OPENFPM
source openfpm_vars
</code></pre>

<h2 id="running-tests-and-examples">Running Tests and Examples</h2>
<p>Optionally, all tests could be run in each module to assure the project and dependencies work correctly</p>
<pre><code class="sh"># openfpm_data
cd openfpm_data
mpirun -np 1 ../build/openfpm_io/openfpm_vcluster/openfpm_data/src/mem_map --run_test=*/* --log_level=test_suite
cd ..

# openfpm_devices
cd openfpm_devices
mpirun -np 1 ../build/openfpm_io/openfpm_vcluster/openfpm_data/openfpm_devices/src/mem --run_test=*/* --log_level=test_suite
cd ..

# openfpm_io
cd openfpm_io
mpirun -np 1 ../build/openfpm_io/src/io --run_test=*/* --log_level=test_suite
cd ..

# openfpm_numerics
cd openfpm_numerics
mpirun -np 3 ../build/openfpm_numerics/src/numerics --run_test=*/* --log_level=test_suite
cd ..

# openfpm_vcluter
cd openfpm_vcluster
mpirun -np 3 ../build/openfpm_io/openfpm_vcluster/src/vcluster_test --run_test=*/* --log_level=test_suite
cd ..

# openfpm_pdata
mpirun -np 3 ./build/src/pdata --log_level=test_suite
</code></pre>

<p>Example simulation codes are compiled with Makefile. For the dependencies (that are not installed system-wide) to be linked properly,
the following compiler options have to be set:</p>
<ul>
<li><em>-llib</em> Search for the library named <em>lib</em> when linking</li>
<li><em>Lloc</em> The location <em>loc</em> where to search for <em>lib</em></li>
<li><em>Idir</em> Add the directory <em>dir</em> to the list of directories to be searched for header files during preprocessing.   </li>
</ul>
<p>This could be done manually when compiling the example codes or with the following tool that produces the file <em>example.mk</em>
The file has to be placed in the folder <em>example</em>.</p>
<pre><code class="sh">./script/create_example.mk.sh $PREFIX_DEPENDS $PREFIX_OPENFPM
mv example.mk example
</code></pre>

<p>In addition to the building from source described below, OpenFPM packages are
also available as pre-built <a href="../download/">binaries</a> and <a href="../docker/">Docker images</a></p></div>
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#building-from-source">Building from source</a></li>
        
            <li><a href="#list-of-supported-os">List of Supported OS</a></li>
        
            <li><a href="#git-subprojects">Git Subprojects</a></li>
        
            <li><a href="#dependencies">Dependencies</a></li>
        
            <li><a href="#building-openfpm">Building OpenFPM</a></li>
        
            <li><a href="#running-tests-and-examples">Running Tests and Examples</a></li>
        
    
    
    </ul>
</div>

<!-- Developer notes:
  See the MkDocs documentation in https://www.mkdocs.org/dev-guide/themes/#page
  and the Jinja2 template API in https://tedboy.github.io/jinja2/index.html
--></div>
            
        </div>
        

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignleft">
                  Developed by <a href = "mailto: yaskovet@mpi-cbg.de">Serhii Yaskovets</a> at
                  <a href="https://tu-dresden.de/ing/informatik/ki/wr">TUD</a>,
                  <a href="https://www.mpi-cbg.de/research/researchgroups/currentgroups/ivo-sbalzarini/group-members">MPI-CBG</a></p>
           </div>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="../js/retina.min.js"></script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../search/main.js"></script>
    </body>
</html>